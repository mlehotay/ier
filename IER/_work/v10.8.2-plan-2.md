# **IER Book — Master Build & Governance Plan (v10.8.2)**

## **Purpose**

This document defines the **single authoritative plan** for:

* how the IER book is structured
* how it is derived from the corpus
* how Pandoc and Make are used
* how structural drift is prevented

It replaces all prior planning notes, partial plans, and informal guidance.

---

## **1. Guiding Principles (Non-Negotiable)**

### 1.1 The Book Is a Derived Artifact

The IER book is **not hand-authored**.

It is a **mechanically derived projection** of authoritative source documents, built reproducibly and validated against drift.

---

### 1.2 Authority Chain (Hard Constraint)

All book-related decisions must respect this dependency order:

```
IER-canon
   ↓
IER-manifest (v10.8.2)
   ↓
IER-book (rules & TOC)
   ↓
IER-publishing (rendering only)
   ↓
Pandoc / Make / output files
```

No downstream document may redefine upstream structure, scope, or membership.

---

### 1.3 Exhaustiveness Rule

The book is:

* **exhaustive** over **Manifest Parts I–III**
* **exclusive** of everything else

Only one exception is permitted:

* the **Preface**, sourced from `IER-paper/IER-paper.md`

---

## **2. What Is Kept vs Changed**

### 2.1 Kept (Confirmed Correct)

* `00-front-matter.md`
  → book front matter only (title, disclaimers, metadata)

* `01-theory.md`, `02-applications.md`, `03-meta.md`
  → **Part boundary sentinels**, not chapters

* `IER-book.md`
  → **book specification** (rules + TOC), not content

* `IER-publishing.md`
  → rendering and production rules only

---

### 2.2 Changed (Unified Resolution)

* No permanently hand-maintained `IER-book.v10.8.2.md` is required
* Instead:

  * **build inputs are generated** from the manifest / book spec
  * **validation is mandatory**
  * drift causes **hard build failure**

---

## **3. Canonical Book Macro-Structure**

The book has **exactly three Parts**.

### 3.1 Canonical Build Order

```
00-front-matter.md
IER-paper/IER-paper.md        ← Preface (non-authoritative)
01-theory.md                 ← Part I sentinel
[Manifest Part I chapters]
02-applications.md           ← Part II sentinel
[Manifest Part II chapters]
03-meta.md                   ← Part III sentinel
[Manifest Part III chapters]
```

No other ordering is permitted.

---

### 3.2 Role of Sentinel Files

Files:

* `01-theory.md`
* `02-applications.md`
* `03-meta.md`

They are **not chapters**.

They exist solely to:

* declare Part boundaries
* anchor TOC structure
* enforce the three-Part constraint

Rules:

* each appears exactly once
* each precedes only its corresponding Part
* content must not introduce chapter-level headers

---

## **4. Role of the Preface (`IER-paper`)**

* Source: `IER-paper/IER-paper.md`
* Status: **non-authoritative**
* Placement:

  * after front matter
  * before Part I
* Validation:

  * explicitly allowed
  * never counted as a chapter

Pandoc treats it as plain content; meaning is enforced by build rules.

---

## **5. Source of Truth for Chapter Membership**

### 5.1 Manifest Authority

`IER-manifest.md` (v10.8.2) defines:

* which documents exist
* which belong to Parts I–III
* which are **explicitly non-book**

The build must be:

* **exhaustive** over Manifest Parts I–III
* **exclusive** of Parts IV–V and all non-corpus material

---

### 5.2 No Implicit Inclusion

Pandoc must **never** infer structure.

The Makefile must **never** hardcode chapter lists.

All inclusion must be **explicit and generated**.

---

## **6. Build Architecture (Canonical)**

### 6.1 Generated Build Input

The build system generates:

```
build/book-input.txt
```

A newline-separated, ordered list of markdown files.

Example (illustrative):

```
00-front-matter.md
../IER-paper/IER-paper.md
01-theory.md
IER-specification.md
IER-theory.md
...
02-applications.md
...
03-meta.md
...
```

This file is the **single input** to Pandoc.

---

### 6.2 Why a Text List

* inspectable
* diffable
* Pandoc-native
* trivial to validate
* avoids monolithic stitched markdown

---

## **7. Mandatory Validation Step**

### 7.1 Validation Goals

Before Pandoc runs, the build must fail if:

* any Manifest Part I–III file is missing
* any non-book file is included
* ordering differs from the manifest
* any sentinel is missing or duplicated
* Preface is missing or misplaced

---

### 7.2 Minimal Implementation

**Scripts**

* `scripts/extract_book_list.py`

  * parses `IER-manifest.md`
  * writes `build/book-input.txt`

* `scripts/validate_book.py`

  * compares:

    * expected = manifest Parts I–III
    * actual = build input
  * exits non-zero on mismatch

---

### 7.3 Makefile Flow (Canonical)

```make
booklist: $(OUTDIR)
	python3 scripts/extract_book_list.py ../IER-manifest.md $(OUTDIR)/book-input.txt

validate: booklist
	python3 scripts/validate_book.py ../IER-manifest.md $(OUTDIR)/book-input.txt

epub: validate
	pandoc $$(cat $(OUTDIR)/book-input.txt) \
	  --toc --toc-depth=2 \
	  --resource-path=. \
	  -o $(OUTDIR)/IER-book.epub
```

Silent success is **not acceptable**.

---

## **8. Responsibilities by File**

### `IER-book.md`

Defines:

* three-Part structure
* exhaustive scope over Manifest Parts I–III
* Preface rule
* TOC with full chapter titles

Does **not** define rendering, layout, or tooling.

---

### `IER-publishing.md`

Defines:

* rendering constraints
* format discipline
* production checklists

Explicitly defers structure to `IER-book.md`.

---

### Makefile

Defines:

* targets
* dependencies
* validation invocation
* Pandoc flags

Does **not** decide content.

---

## **9. Pandoc Usage Discipline**

Pandoc is a **renderer only**.

Permitted responsibilities:

* concatenate files **already ordered**
* generate TOC
* emit HTML / EPUB / PDF

Forbidden responsibilities:

* inferring structure
* selecting chapters
* resolving authority

---

## **10. Output Strategy**

| Format | Role                      |
| ------ | ------------------------- |
| HTML   | fast preview              |
| EPUB   | structural truth          |
| PDF    | archival / citation       |
| DOCX   | optional external editing |

PDF is **last**, after structure stabilizes.

---

## **11. Changelog Policy**

For v10.8.2, record **once**, tersely:

* Preface addition
* three-Part structure reaffirmed
* manifest / book / publishing alignment
* validation added

No forward-looking promises.

---

## **12. Hygiene Sweep Requirement**

Repo-wide search and correction of:

* “division”
* “two parts”
* legacy structure language

Everything must now say:

* **three Parts**
* **manifest-driven**
* **v10.8.2**

---

## **13. Definition of Done**

This plan is complete when:

1. Manifest v10.8.2 cleanly separates book vs non-book material
2. `IER-book.md` defines a three-Part exhaustive book
3. Preface is included and validated
4. Build input is generated, not handwritten
5. Validation fails on any drift
6. Pandoc never infers structure
7. Changelog reflects the change once

---

## **Final Statement**

> The IER book is a **mechanically derivable, validation-first artifact** whose structure is fixed upstream, whose rendering is downstream, and whose build must fail loudly whenever authority boundaries are violated.

---
---

## Tasks in the plan that do **not** depend on Make or Pandoc

1. finalize/verify the chapter list in `IER-book.md` (TOC spec)
2. ensure `IER-manifest.md` Parts I–III match it exactly,
3. implement `extract_book_list.py` + `validate_book.py` and run them manually.


### Upstream structure + content hygiene (fully tool-independent)

* **Confirm the canonical macro-structure** is reflected everywhere:
  *Front matter → Preface → Part I sentinel → Part I chapters → Part II sentinel → Part II chapters → Part III sentinel → Part III chapters.*
* **Verify the sentinel files** are correct *as sentinels* (not chapters) and obey the rules (appear once; no chapter-level headers).
* **Hygiene sweep**: repo-wide removal of legacy language (“division”, “two parts”), replaced with “three Parts”, “manifest-driven”, “v10.8.2”.

### Authority alignment (no build tooling required)

* **Ensure the dependency order is consistently stated** (canon → manifest → book → publishing → tooling/output).
* **Ensure scope discipline** is reflected in docs:

  * `IER-book.md` = structure + TOC rules (not content)
  * `IER-publishing.md` = rendering/production rules only (defers structure to `IER-book.md`)
  * `00-front-matter.md` = front matter only (disclaimers/metadata/orientation)

### Manifest and book-spec readiness work (still no Make/Pandoc)

* **Make sure `IER-manifest.md` (v10.8.2)** cleanly enumerates exactly what belongs to Parts I–III (and excludes non-book material), because the plan treats the manifest as the *source of truth for membership and order*.
* **Confirm `IER-book.md` contains the complete chapter list and titles** (the canonical TOC specification), matching Manifest Parts I–III exactly.
* **Preface placement rule**: verify the Preface source (`IER-paper/IER-paper.md`) is conceptually slotted after front matter and before Part I sentinel, and is explicitly treated as “allowed but not a chapter.”

### Script work (doesn’t require Make or Pandoc)

The plan’s validation-first approach can be implemented *without* Make/Pandoc by running scripts manually:

* Write `scripts/extract_book_list.py` to parse the manifest and output an ordered file list (`build/book-input.txt`).
* Write `scripts/validate_book.py` to compare expected (manifest Parts I–III + required sentinels + Preface placement) vs actual list; fail loudly on drift.

You can run these directly (e.g., `python3 scripts/validate_book.py ...`) and get the “drift-proofing” benefits before you ever write a Makefile.

---
---

## Should we create a Table of Contents? Where does it go? Autogenerated or manual?

### Yes: you should have a **canonical TOC specification** now

Per the plan, **`IER-book.md` is where the TOC (titles + ordering) lives as the authoritative structural spec**—it’s not “book content,” it’s the *contract* that the build must match.

This TOC spec is what your validation checks should ultimately defend.

### The rendered book TOC should be **autogenerated**

The plan is explicit that **Pandoc is a renderer only** and that it should **generate the TOC** (e.g., via `--toc`) from the already-ordered inputs.

So the recommended split is:

* **Human-maintained TOC (source of truth):** `IER-book.md` (complete list of chapters/titles in order)
* **Reader-facing TOC (in outputs):** autogenerated by the renderer (Pandoc), once you’re ready

### Where does the TOC “go” in the assembly?

In the plan’s build order, your front matter and Preface come first, then Part I begins.
So when you later render, the TOC should appear in the usual front-matter region (after title/metadata pages). Practically, Pandoc can insert it automatically; you don’t need to hand-write a TOC page into `00-front-matter.md` unless you have a specific print-layout reason.

**Right now (pre-Pandoc), the key is:** make `IER-book.md`’s TOC complete and correct, and make your scripts validate against it/against the manifest.

---
